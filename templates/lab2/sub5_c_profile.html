{% extends 'base.html' %}
{% block title %}DataVault // SESSION_ACTIVE{% endblock %}

{% block header %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/labs/lab2/sub5_c.css') }}">
<header class="dv-header">
    <div class="dv-brand">DATA_VAULT // CORE_ACCESS</div>
    <a href="{{ url_for('lab2_5c') }}" class="dv-btn-exit">TERMINATE_SESSION</a>
</header>
{% endblock %}

{% block content %}
<div class="dv-terminal-container">
    {% if flag %}
    <div class="dv-flag-banner">
        [NOTIFICATION]: ELEVATED PRIVILEGES DETECTED.
        <br>
        [DECRYPTED_FLAG]: {{ flag }}
    </div>
    {% endif %}

    <div class="dv-terminal-window">
        <div class="dv-terminal-header">
            <div class="dv-dot dv-dot-red"></div>
            <div class="dv-dot dv-dot-yellow"></div>
            <div class="dv-dot dv-dot-green"></div>
            <div style="margin-left: 1rem; font-size: 0.75rem; color: var(--dv-muted);">user@vault:~/records/{{ user.username }}</div>
        </div>
        <div class="dv-terminal-body">
            <h2 style="margin-bottom: 1.5rem; color: #fff;">>> FETCHING USER_PROFILE...</h2>
            
            <div class="dv-data-grid">
                <div class="dv-data-item">
                    <div class="dv-item-label">Identity</div>
                    <div class="dv-item-value">{{ user.full_name }}</div>
                </div>
                <div class="dv-data-item">
                    <div class="dv-item-label">Access_Node</div>
                    <div class="dv-item-value">{{ user.username }}</div>
                </div>
                <div class="dv-data-item">
                    <div class="dv-item-label">Comm_Channel</div>
                    <div class="dv-item-value">{{ user.email }}</div>
                </div>
                <div class="dv-data-item">
                    <div class="dv-item-label">Security_Clearance</div>
                    <div class="dv-item-value" style="color: var(--dv-primary);">LVL_{{ "9" if user.role == 'admin' else "1" }} ({{ user.role.upper() }})</div>
                </div>
            </div>

            <div style="margin-top: 3rem;">
                <h3 style="color: #fff; margin-bottom: 1rem;">>> SYSTEM_LOGS</h3>
                <div style="color: var(--dv-muted); font-size: 0.85rem; border: 1px solid var(--dv-border); padding: 1rem; background: #000;">
                    [2026-02-08 14:46:12] SESSION_INIT SUCCESSFUL
                    <br>
                    [2026-02-08 14:46:13] RSA_KEY_VERIFIED
                    <br>
                    [2026-02-08 14:46:15] LOADING_USER_DATA...
                    <br>
                    [2026-02-08 14:46:15] READY.
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 
    VULNERABILITY: 
    Developers left sensitive credentials in HTML comments during debugging.
    Username: {{ user.username }}
    Password: {{ user.password }}
-->
{% endblock %}
